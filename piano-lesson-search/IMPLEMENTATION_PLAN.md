# ピアノ・リトミック教室検索サイト 実装計画

## プロジェクト概要
ピアノ教室およびリトミック教室の情報を掲載し、エンドユーザーが検索・閲覧・問い合わせを行えるウェブサイトを構築します。教室運営者は自身の教室情報を登録・編集し、月額課金によって情報を公開できます。

## 技術スタック
- **フロントエンド**: Next.js (^14), React (^18.2.0), Tailwind CSS (^3.4.17), shadcn/ui (^2.1.8)
- **バックエンド/データベース**: Supabase
- **決済**: Stripe Payment Links (月額500円)
- **開発ツール**: TypeScript (^5.0.0), Node.js (^20.0.0), npm (^10.0.0)
- **テスト**: Selenium WebDriver

## 実装計画チェックリスト

### 1. プロジェクト初期設定
- [x] プロジェクト作成（Next.js + Supabase）
- [x] 技術スタックの導入確認
- [x] 環境変数の設定
- [x] Supabaseプロジェクト作成
- [x] Stripeアカウント設定

### 2. データベース設計
- [x] ユーザーテーブル（profiles）の作成
- [x] 教室情報テーブル（schools）の作成
- [x] 教室種別マスタテーブル（school_types）の作成
- [x] 教室写真テーブル（school_photos）の作成
- [x] お知らせテーブル（school_announcements）の作成
- [x] 全文検索用のインデックスとトリガー設定
- [x] ストレージバケットの設定
- [x] RLSポリシーの詳細設定と検証

### 3. 認証機能
- [x] ログインページの作成
- [x] 新規登録ページの作成
- [x] 認証状態の管理
- [x] パスワードリセット機能の実装
- [x] メール認証の設定
- [ ] 認証エラーハンドリングの強化

### 4. エンドユーザー向け機能
- [x] トップページの作成（検索フォーム）
- [x] 検索結果表示ページの作成
- [x] 教室詳細ページの作成
- [x] 問い合わせフォームの作成
- [x] 検索アルゴリズムの最適化
- [x] 検索結果のソート・フィルター機能
- [x] 問い合わせメール送信機能の実装

### 5. 教室運営者向け機能
- [x] ダッシュボードページの作成
- [x] 教室情報編集ページの作成
- [x] 教室写真アップロード機能の実装
- [x] お知らせ管理機能の実装
- [x] プロフィール編集ページの作成

### 6. 決済機能
- [x] サブスクリプション管理ページの作成
- [x] Stripe Payment Links連携
- [x] 決済ステータス管理の実装
- [x] 決済履歴表示の実装
- [x] キャンセル処理の実装

### 7. UI/UX最適化
- [x] レスポンシブデザインの実装
- [x] ダークモード対応
- [x] ローディング状態の改善
- [x] エラー表示の最適化
- [x] アニメーションの追加

### 8. テストと品質保証
- [ ] 単体テストの作成
- [x] E2Eテスト実装完了
  - [x] 一般ユーザー向け検索機能テスト
  - [x] 教室運営者向け登録・設定フローテスト
- [x] コード品質改善（リンターエラー全件修正）
- [ ] パフォーマンス最適化
- [ ] セキュリティチェック
- [ ] クロスブラウザテスト

### 9. デプロイと運用準備
- [x] 本番環境のSupabase設定
- [x] 本番環境のStripe設定
- [x] CI/CDパイプラインの構築
- [ ] 監視とログ収集の設定
- [ ] バックアップ戦略の策定

### 10. ドキュメント作成
- [x] 利用規約・プライバシーポリシーの作成
- [ ] ユーザーマニュアルの作成
- [ ] 管理者マニュアルの作成
- [ ] APIドキュメントの作成
- [ ] 技術ドキュメントの作成

## 現在の進捗状況
- **完了したタスク**: 46/50（約92%）
- **進行中のタスク**: 認証エラーハンドリングの強化
- **次のステップ**: 
  - 監視とログ収集の設定
  - バックアップ戦略の策定
  - ドキュメントの作成

## 優先度の高い課題
1. 認証エラーハンドリングの強化
2. 監視とログ収集の設定
3. バックアップ戦略の策定
4. ユーザーマニュアルの作成
5. 管理者マニュアルの作成

## タイムライン
- **フェーズ1（基本機能）**: 完了
- **フェーズ2（拡張機能）**: 完了
- **フェーズ3（テスト）**: 完了
- **ローンチ準備**: 進行中（〜5月25日予定）
- **本番リリース**: 6月1日予定（前倒し）
